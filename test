agg_funcs = {
    "status": lambda x: "fail" if "fail" in x.values else "pass",
    "component_typr": "first",
    "source": lambda x: ','.join(x.unique()),
    "replica_number": "count",
    "record_count": lambda x: ','.join(map(str, x.unique()))
}

final_df = df.groupby("componenent_name").agg(agg_funcs).reset_index()
