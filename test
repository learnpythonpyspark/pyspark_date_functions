import pandas as pd

def read_custom_table(file_content):
    lines = file_content.strip().split('\n')
    data = []
    headers = None
    header_count = 0
    
    for line in lines:
        if line.startswith('+'):
            continue
        if 'cola.' in line:
            header_count += 1
            if header_count == 1:
                headers = [col.strip() for col in line.split('|') if col.strip()]
                headers = [h[:-1] if h.endswith('.') else h for h in headers]
            continue
        
        row = [col.strip() for col in line.split('|') if col.strip()]
        if len(row) == len(headers):
            data.append(row)
    
    return pd.DataFrame(data, columns=headers)



with open('abc.txt', 'r') as file:
    file_content = file.read()

df = read_custom_table(file_content)

print(df)
